<!-- ğŸ“Œ Find All the Factors Game v2 - 60 ç§’è¨ˆæ™‚ & æ™‚é–“åŠ åˆ†ç‰ˆ -->
<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>å› æ•¸é…å°éŠæˆ²ï½œFind All the Factors</title>
    <style>
      /* ===== ğŸ¨ ä»‹é¢æ¨£å¼è¨­å®š ===== */
      html,
      body {
        margin: 0;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #2b235a; /* ç´«è—èƒŒæ™¯ */
        font-family: "Noto Sans TC", sans-serif;
      }
      #game-wrapper {
        background: #ffffff;
        color: #333;
        border-radius: 24px;
        padding: 32px 28px 40px;
        width: min(92vw, 500px);
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.3);
        text-align: center;
      }
      h1 {
        margin: 0 0 12px;
        color: #2b235a;
        font-size: 2rem;
      }
      #stats {
        display: flex;
        justify-content: space-between;
        font-weight: 700;
        margin-bottom: 6px;
      }
      #target-number {
        font-size: 1.5rem;
        font-weight: 700;
        color: #2b235a;
        margin: 14px 0 6px;
      }
      #options {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin-top: 12px;
      }
      .option-btn {
        padding: 12px 0;
        border: none;
        border-radius: 14px;
        background: #eef1ff;
        font-size: 1.1rem;
        cursor: pointer;
        transition: transform 0.15s;
      }
      .option-btn:hover {
        transform: scale(1.05);
      }
      .option-btn.correct {
        background: #43d14d;
        color: #fff;
        animation: flash 0.35s alternate 2;
      }
      .option-btn.wrong {
        animation: shake 0.3s;
        background: #f9c8c8;
      }
      .option-btn:disabled {
        opacity: 0.65;
        cursor: default;
      }
      #timer {
        color: #ffda44;
      }
      @keyframes flash {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.13);
        }
      }
      @keyframes shake {
        10%, 90% {
          transform: translateX(-2px);
        }
        20%, 80% {
          transform: translateX(4px);
        }
        30%, 50%, 70% {
          transform: translateX(-6px);
        }
        40%, 60% {
          transform: translateX(6px);
        }
      }
    </style>
  </head>
  <body>
    <div id="game-wrapper">
      <h1>å› æ•¸é…å°éŠæˆ²</h1>
      <div id="stats">
        <span id="level">ç¬¬ 1 é—œ</span>
        <span id="score">åˆ†æ•¸ï¼š0</span>
        <span id="timer">å€’æ•¸ï¼š60 ç§’</span>
      </div>
      <div id="target-number">è«‹æ‰¾å‡º 22 çš„æ‰€æœ‰å› æ•¸</div>
      <div id="options"></div>
    </div>

    <!-- éŸ³æ•ˆï¼ˆè‡ªè¡Œæ›¿æ›ï¼‰ -->
    <audio id="correct-sound" src="correct.mp3" preload="auto"></audio>
    <audio id="wrong-sound" src="wrong.mp3" preload="auto"></audio>

    <script>
      // ===== ğŸ§  éŠæˆ²é‚è¼¯ =====
      const QUESTION_TIME = 60; // æ¯é¡Œ 60 ç§’
      const BASE_SCORE = 10;    // åŸºç¤åˆ†æ•¸

      let currentScore = 0;
      let currentLevel = 1;
      let timeLeft = QUESTION_TIME;
      let countdownInterval;

      const $score = document.getElementById("score");
      const $level = document.getElementById("level");
      const $timer = document.getElementById("timer");
      const $target = document.getElementById("target-number");
      const $options = document.getElementById("options");

      const correctSound = document.getElementById("correct-sound");
      const wrongSound   = document.getElementById("wrong-sound");

      function getFactors(num) {
        const list = [];
        for (let i = 1; i <= num; i++) if (num % i === 0) list.push(i);
        return list;
      }

      function generateOptions(target) {
        const factors = getFactors(target);
        const set = new Set(factors);
        while (set.size < 12) set.add(Math.floor(Math.random() * 50) + 1);
        return Array.from(set).sort(() => Math.random() - 0.5);
      }

      function updateStats() {
        $score.textContent = `åˆ†æ•¸ï¼š${currentScore}`;
        $level.textContent = `ç¬¬ ${currentLevel} é—œ`;
        $timer.textContent = `å€’æ•¸ï¼š${timeLeft} ç§’`;
      }

      function startCountdown() {
        clearInterval(countdownInterval);
        countdownInterval = setInterval(() => {
          timeLeft--;
          $timer.textContent = `å€’æ•¸ï¼š${timeLeft} ç§’`;
          if (timeLeft <= 0) {
            clearInterval(countdownInterval);
            alert(`æ™‚é–“åˆ°ï¼\néŠæˆ²çµæŸï¼Œä½ çš„åˆ†æ•¸æ˜¯ï¼š${currentScore}`);
            resetGame();
          }
        }, 1000);
      }

      function nextQuestion() {
        timeLeft = QUESTION_TIME;
        updateStats();

        const target  = Math.floor(Math.random() * 91) + 10; // 10~100
        const factors = getFactors(target);
        const opts    = generateOptions(target);

        $target.textContent = `è«‹æ‰¾å‡º ${target} çš„æ‰€æœ‰å› æ•¸`;
        $options.innerHTML  = "";

        opts.forEach(num => {
          const btn = document.createElement("button");
          btn.className = "option-btn";
          btn.textContent = num;
          btn.addEventListener("click", () => handleChoice(btn, num, factors));
          $options.appendChild(btn);
        });

        startCountdown();
      }

      function handleChoice(btn, num, factors) {
        if (factors.includes(num)) {
          btn.classList.add("correct");
          btn.disabled = true;
          correctSound && correctSound.play();

          const found = $options.querySelectorAll(".correct").length;
          if (found === factors.length) {
            clearInterval(countdownInterval);
            const timeBonus = timeLeft; // å‰©é¤˜ç§’æ•¸ä½œç‚ºåŠ åˆ†
            const gained    = BASE_SCORE + timeBonus;
            currentScore   += gained;
            currentLevel++;

            const timeUsed = QUESTION_TIME - timeLeft;
            alert(`ç­”å°ï¼\næ‰€èŠ±æ™‚é–“ï¼š${timeUsed} ç§’\næœ¬é—œå¾—åˆ†ï¼š${gained}`);
            nextQuestion();
          }
        } else if (!btn.classList.contains("wrong")) {
          btn.classList.add("wrong");
          wrongSound && wrongSound.play();
        }
      }

      function resetGame() {
        currentScore = 0;
        currentLevel = 1;
        nextQuestion();
      }

      // ===== ğŸš€ å•Ÿå‹•éŠæˆ² =====
      document.addEventListener("DOMContentLoaded", nextQuestion);
    </script>
  </body>
</html>
